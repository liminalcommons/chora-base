# Upgrade Guide: v3.1.x → v3.2.0

**Target Audience:** Existing chora-base v3.0.0 - v3.1.1 projects
**Upgrade Time:** 5-30 minutes (depending on adoption level)
**Breaking Changes:** None (fully backward compatible)

---

## What's New in v3.2.0

**Agentic Development Framework** - Complete evidence-based development process:

- **7,440+ lines of workflow documentation** (DDD, BDD, TDD, ANTI_PATTERNS, complete example)
- **Project management templates** (sprint planning, release planning, process metrics)
- **Enhanced blueprints** (README, ROADMAP with workflow integration)
- **Real-world validation** (OAuth2 walkthrough: 27% efficiency gain, 40-80% defect reduction)

**Key Benefits:**
- Reduce defect rate by 40-80% (Microsoft Research)
- Save 8-15 hours per feature (DDD prevents rework)
- Prevent 2-5 acceptance issues per feature (BDD)
- Achieve 80-90% sprint velocity predictability

---

## Upgrade Steps

### Step 1: Copy Workflow Documentation

**Required for basic workflow support:**

```bash
# Navigate to your project directory
cd your-project

# Copy all workflow docs
cp -r /path/to/chora-base/static-template/dev-docs/workflows/ dev-docs/

# Copy anti-patterns guide
cp /path/to/chora-base/static-template/dev-docs/ANTI_PATTERNS.md dev-docs/

# Copy complete example
cp -r /path/to/chora-base/static-template/dev-docs/examples/ dev-docs/
```

**Time:** 2 minutes

---

### Step 2: Copy Project Management Templates

**Required for sprint planning and metrics tracking:**

```bash
# Copy sprint planning templates
cp -r /path/to/chora-base/static-template/project-docs/sprints/ project-docs/

# Copy release planning (if project-docs/releases doesn't exist)
cp -r /path/to/chora-base/static-template/project-docs/releases/ project-docs/

# Copy process metrics
cp -r /path/to/chora-base/static-template/project-docs/metrics/ project-docs/
```

**Time:** 2 minutes

---

### Step 3: Update README.md (Recommended)

**Add "Development Process" section after "Usage":**

```bash
# Option 1: Manual edit
# Open README.md and add the "Development Process" section
# See blueprints/README.md.blueprint lines 50-70 for template

# Option 2: View template for reference
cat /path/to/chora-base/blueprints/README.md.blueprint
```

**Section to add:**

```markdown
## Development Process

This project follows the chora-base 8-phase development lifecycle.

### 8-Phase Lifecycle

1. **Vision & Strategy** → [ROADMAP.md](ROADMAP.md)
2. **Planning** → [Sprint Planning](project-docs/sprints/README.md)
3. **Requirements & Design** → [DDD Workflow](dev-docs/workflows/DDD_WORKFLOW.md) (saves 8-15 hours)
4. **Development** → [BDD](dev-docs/workflows/BDD_WORKFLOW.md) + [TDD](dev-docs/workflows/TDD_WORKFLOW.md) (40-80% fewer defects)
5. **Testing & Quality** → Built into all workflows
6. **Review & Integration** → [AGENTS.md](AGENTS.md) PR process
7. **Release & Deployment** → [Release Planning](project-docs/releases/RELEASE_PLANNING_GUIDE.md)
8. **Monitoring & Feedback** → [Process Metrics](project-docs/metrics/PROCESS_METRICS.md)

### Quick Reference for AI Agents

**Decision Trees:**
- Write docs first? → **YES** ([DDD Workflow](dev-docs/workflows/DDD_WORKFLOW.md))
- Write acceptance tests first? → **YES** ([BDD Workflow](dev-docs/workflows/BDD_WORKFLOW.md))
- Write unit tests first? → **YES** ([TDD Workflow](dev-docs/workflows/TDD_WORKFLOW.md))
- Sprint commitment? → **<80% capacity** ([Sprint Planning](project-docs/sprints/README.md))

**Complete Example:** [OAuth2 Feature Walkthrough](dev-docs/examples/FEATURE_WALKTHROUGH.md) (14 days, 56 hours, 27% efficiency gain)
```

**Time:** 5-10 minutes

---

### Step 4: Update ROADMAP.md (If Exists)

**Add "How We Execute This Roadmap" section at the top:**

```bash
# Option 1: Manual edit
# Open ROADMAP.md and add section after header

# Option 2: View template for reference
cat /path/to/chora-base/blueprints/ROADMAP.md.blueprint
```

**Section to add:**

```markdown
## How We Execute This Roadmap

### Sprint Planning

**Process:** [project-docs/sprints/README.md](project-docs/sprints/README.md)

- **Cadence:** 1-2 week sprints with clear goals
- **Capacity Planning:** Never commit >80% of available capacity
- **Tracking:** Velocity and burndown charts in sprint templates
- **Retrospectives:** End of each sprint to refine process

### Development Process

**Complete Workflow:** [dev-docs/workflows/DEVELOPMENT_PROCESS.md](dev-docs/workflows/DEVELOPMENT_PROCESS.md)

- **DDD (Documentation-First):** Write docs before code → saves 8-15 hours of rework
- **BDD (Behavior-Driven):** Define acceptance criteria with Gherkin → prevents 2-5 acceptance issues
- **TDD (Test-Driven):** RED-GREEN-REFACTOR cycle → 40-80% fewer defects (Microsoft Research)

**Time Investment Per Feature:**
- DDD upfront: 3-5 hours
- BDD upfront: 2-4 hours
- TDD continuous: 40% of development time
- Total: 10-19 hours per feature (average 14 hours)

### Quality Gates

**Measured in:** [project-docs/metrics/PROCESS_METRICS.md](project-docs/metrics/PROCESS_METRICS.md)

- **Test Coverage:** ≥85% (enforced in CI/CD)
- **Process Adherence:** ≥90% workflow compliance
- **Defect Rate:** <3 defects per release
- **Sprint Velocity:** 80-90% of committed work delivered
```

**Time:** 5-10 minutes

---

### Step 5: Update AGENTS.md (Recommended)

**Add workflow cross-references to existing sections:**

```bash
# Open AGENTS.md and add references in relevant sections
```

**Sections to enhance:**

1. **In "Development Workflow" section:**
   ```markdown
   **Complete Process Documentation:**
   - [8-Phase Development Lifecycle](dev-docs/workflows/DEVELOPMENT_LIFECYCLE.md)
   - [DDD Workflow](dev-docs/workflows/DDD_WORKFLOW.md) - Write docs first (saves 8-15 hours)
   - [BDD Workflow](dev-docs/workflows/BDD_WORKFLOW.md) - Acceptance tests (prevents 2-5 issues)
   - [TDD Workflow](dev-docs/workflows/TDD_WORKFLOW.md) - Test-driven (40-80% fewer defects)
   ```

2. **In "Project Planning" section:**
   ```markdown
   **Sprint Planning:**
   - [Sprint Planning Guide](project-docs/sprints/README.md)
   - Capacity: Never commit >80% of available capacity
   - Velocity target: Deliver 80-90% of committed work
   ```

3. **Add "Complete Example" section:**
   ```markdown
   ## Complete Example

   **OAuth2 Feature Walkthrough:** [dev-docs/examples/FEATURE_WALKTHROUGH.md](dev-docs/examples/FEATURE_WALKTHROUGH.md)
   - 14 days (56 hours) across all 8 phases
   - 95% test coverage, zero production bugs
   - 27% efficiency gain (17 hours saved)
   - Real data: time estimates, defects found, ROI calculations
   ```

**Time:** 5-10 minutes

---

## Validation Steps

### Verify Files Copied

```bash
# Check workflow documentation
ls -lh dev-docs/workflows/
# Expected: DEVELOPMENT_PROCESS.md, DEVELOPMENT_LIFECYCLE.md, DDD_WORKFLOW.md, BDD_WORKFLOW.md, TDD_WORKFLOW.md, README.md

ls -lh dev-docs/ANTI_PATTERNS.md
# Expected: ~1,309 lines

ls -lh dev-docs/examples/
# Expected: FEATURE_WALKTHROUGH.md, README.md

# Check project management templates
ls -lh project-docs/sprints/
# Expected: README.md, sprint-template.md

ls -lh project-docs/metrics/
# Expected: PROCESS_METRICS.md

ls -lh project-docs/releases/
# Expected: RELEASE_PLANNING_GUIDE.md, release-template.md
```

### Verify Documentation Links

```bash
# Test key documentation paths (should all exist)
test -f dev-docs/workflows/DEVELOPMENT_LIFECYCLE.md && echo "✅ DEVELOPMENT_LIFECYCLE.md"
test -f dev-docs/workflows/DDD_WORKFLOW.md && echo "✅ DDD_WORKFLOW.md"
test -f dev-docs/workflows/BDD_WORKFLOW.md && echo "✅ BDD_WORKFLOW.md"
test -f dev-docs/workflows/TDD_WORKFLOW.md && echo "✅ TDD_WORKFLOW.md"
test -f dev-docs/examples/FEATURE_WALKTHROUGH.md && echo "✅ FEATURE_WALKTHROUGH.md"
test -f project-docs/sprints/README.md && echo "✅ Sprint Planning Guide"
test -f project-docs/metrics/PROCESS_METRICS.md && echo "✅ Process Metrics"
```

---

## Next Steps

### Start Using Workflows

**For Your Next Feature:**

1. **Read the lifecycle overview** (30 minutes)
   ```bash
   cat dev-docs/workflows/DEVELOPMENT_LIFECYCLE.md
   ```

2. **Follow DDD → BDD → TDD sequence:**
   - Phase 1: Write docs first ([DDD_WORKFLOW.md](dev-docs/workflows/DDD_WORKFLOW.md))
   - Phase 2: Write acceptance tests ([BDD_WORKFLOW.md](dev-docs/workflows/BDD_WORKFLOW.md))
   - Phase 3: Implement with TDD ([TDD_WORKFLOW.md](dev-docs/workflows/TDD_WORKFLOW.md))

3. **Track metrics:**
   ```bash
   # Update process metrics after each sprint
   vim project-docs/metrics/PROCESS_METRICS.md
   ```

4. **Reference complete example:**
   ```bash
   # See real-world OAuth2 implementation
   cat dev-docs/examples/FEATURE_WALKTHROUGH.md
   ```

### Plan Your Next Sprint

1. **Review sprint planning guide:**
   ```bash
   cat project-docs/sprints/README.md
   ```

2. **Create sprint document:**
   ```bash
   cp project-docs/sprints/sprint-template.md project-docs/sprints/sprint-001.md
   # Edit sprint-001.md with your goals and capacity
   ```

3. **Use workflow time estimates:**
   - DDD: 3-5 hours per feature
   - BDD: 2-4 hours per feature
   - TDD: 40% of total development time
   - **Total:** 10-19 hours per feature (average 14 hours)

4. **Never commit >80% of capacity:**
   - If you have 20 hours available → commit max 16 hours
   - Reserve 20% buffer for unknowns, bugs, tech debt

---

## Optional: Adopt Workflows for Existing Features

### Retroactive Documentation (DDD)

If you have existing features without documentation:

1. **Prioritize high-value features:**
   - Most frequently used
   - Most bug-prone
   - Most requested for changes

2. **Write docs after-the-fact:**
   - Use [DDD_WORKFLOW.md](dev-docs/workflows/DDD_WORKFLOW.md) as template
   - Document current behavior (not ideal behavior)
   - Identify gaps between docs and reality

3. **ROI:**
   - Saves time for future modifications
   - Helps new team members onboard
   - Reduces bus factor risk

### Add Tests to Existing Code (TDD)

If you have existing features without tests:

1. **Start with high-risk areas:**
   - Core business logic
   - Authentication/authorization
   - Data validation

2. **Write characterization tests:**
   - Document current behavior (even if buggy)
   - Use [TDD_WORKFLOW.md](dev-docs/workflows/TDD_WORKFLOW.md) for guidance
   - Refactor once tests are green

3. **Track coverage improvement:**
   ```bash
   # Update metrics regularly
   vim project-docs/metrics/PROCESS_METRICS.md
   ```

---

## FAQ

### Do I need to adopt all workflows at once?

**No.** You can adopt incrementally:

1. **Week 1:** Read documentation, plan next sprint with time estimates
2. **Week 2:** Try DDD for one feature
3. **Week 3:** Add BDD for acceptance criteria
4. **Week 4:** Implement TDD for new code
5. **Month 2:** Measure results, refine process

### Can I skip workflows for small bug fixes?

**Yes.** Decision trees in [dev-docs/workflows/README.md](dev-docs/workflows/README.md) provide guidance:

- **Trivial bug fixes (<30 min):** Can skip DDD
- **Infrastructure changes (no user-facing behavior):** Can skip BDD
- **Throwaway prototypes/spikes:** Can skip TDD

**Rule of thumb:** If it's going to production, use workflows.

### What if my estimates are way off?

**Normal.** It takes 2-3 sprints to calibrate estimates:

1. **Track actuals:** Record time spent vs. estimated
2. **Review retrospectives:** Analyze variances
3. **Adjust factors:** Multiply base estimates by your team's factor
4. **Improve over time:** Target 80-90% estimation accuracy

**Example:** If DDD consistently takes 6 hours instead of 4, adjust your estimates.

### How do I measure ROI?

**Use process metrics:**

1. **Track defects:**
   - Before workflows: X defects per release
   - After workflows: Y defects per release
   - Reduction: (X-Y)/X * 100%

2. **Track rework:**
   - Count "we should have done it this way" refactors
   - Estimate time wasted on rework
   - Compare to DDD upfront investment

3. **Track velocity:**
   - Sprint commitment vs. delivery
   - Target: 80-90% velocity consistently

**See:** [project-docs/metrics/PROCESS_METRICS.md](project-docs/metrics/PROCESS_METRICS.md) for tracking templates

---

## Troubleshooting

### Links don't work in generated project

**Cause:** Relative paths may differ if you customized directory structure

**Solution:**
1. Find broken link: `grep -r "broken-path" dev-docs/`
2. Update to correct relative path
3. Test with `test -f path/to/file.md`

### Time estimates seem way too high

**Cause:** Base estimates are for comprehensive implementation

**Solution:**
1. Start tracking actuals for your team
2. Calculate your velocity factor (actual/estimated)
3. Adjust future estimates by your factor
4. Remember: Includes documentation, tests, review, not just coding

### Workflows feel too rigid

**Cause:** Dogmatic application without understanding context

**Solution:**
1. Read [dev-docs/ANTI_PATTERNS.md](dev-docs/ANTI_PATTERNS.md) for when to deviate
2. Use decision trees for guidance, not rules
3. Adapt to your context (team size, domain, risk tolerance)
4. Measure results, not just process adherence

---

## Getting Help

**Documentation:**
- [Workflow README](dev-docs/workflows/README.md) - Overview and decision trees
- [Development Lifecycle](dev-docs/workflows/DEVELOPMENT_LIFECYCLE.md) - How phases connect
- [Anti-Patterns](dev-docs/ANTI_PATTERNS.md) - Common mistakes to avoid
- [Complete Example](dev-docs/examples/FEATURE_WALKTHROUGH.md) - Real-world walkthrough

**Questions:**
- Open an issue on chora-base GitHub
- Review ANTI_PATTERNS.md for your specific challenge
- Compare to FEATURE_WALKTHROUGH.md for reference

**Contributing:**
- Share your own walkthrough examples
- Submit workflow improvements based on learnings
- Help refine time estimates with your data

---

## Summary

**What You Did:**
1. ✅ Copied 7,440+ lines of workflow documentation
2. ✅ Added project management templates (sprints, releases, metrics)
3. ✅ Enhanced README.md with development process (optional)
4. ✅ Updated ROADMAP.md with execution details (optional)
5. ✅ Enhanced AGENTS.md with workflow references (optional)

**What You Get:**
- **40-80% defect reduction** (Microsoft Research)
- **8-15 hours saved per feature** (DDD prevents rework)
- **2-5 acceptance issues prevented** (BDD catches misalignment)
- **80-90% sprint velocity** (predictable delivery)

**Next Steps:**
1. Read [dev-docs/workflows/DEVELOPMENT_LIFECYCLE.md](dev-docs/workflows/DEVELOPMENT_LIFECYCLE.md)
2. Plan next sprint with workflow time estimates
3. Try DDD → BDD → TDD for next feature
4. Track metrics and refine process

**Total Upgrade Time:** 5-30 minutes (depending on optional steps adopted)

---

**For detailed release notes, see:** [v3.2.0-release-notes.md](v3.2.0-release-notes.md)

**For changelog, see:** [CHANGELOG.md](../../CHANGELOG.md#320---2025-10-26)
