{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://chora.dev/schemas/traceability-frontmatter/v1.0.0",
  "title": "Traceability Frontmatter Schema",
  "description": "Schema for YAML frontmatter in documentation files - enables SAP-056 (Lifecycle Traceability) doc→code linkage",
  "type": "object",
  "properties": {
    "title": {
      "type": "string",
      "description": "Document title",
      "minLength": 1,
      "examples": ["How to Implement Authentication", "API Reference: Auth Module"]
    },
    "feature_id": {
      "type": "string",
      "description": "Primary feature this doc describes (FEAT-XXX)",
      "pattern": "^FEAT-[A-Z0-9-]+$",
      "examples": ["FEAT-001", "FEAT-AUTH-001"]
    },
    "feature_ids": {
      "type": "array",
      "description": "Multiple features documented in this file (optional)",
      "items": {
        "type": "string",
        "pattern": "^FEAT-[A-Z0-9-]+$"
      },
      "minItems": 1,
      "examples": [["FEAT-001", "FEAT-002"]]
    },
    "code_references": {
      "type": "array",
      "description": "Code files referenced in this documentation",
      "items": {
        "type": "string",
        "minLength": 1
      },
      "minItems": 1,
      "examples": [["src/auth/providers.py", "src/auth/middleware.py"]]
    },
    "test_references": {
      "type": "array",
      "description": "Test files referenced in this documentation",
      "items": {
        "type": "string",
        "minLength": 1
      },
      "minItems": 1,
      "examples": [["tests/test_auth.py::test_email_login", "tests/test_auth_integration.py"]]
    },
    "doc_type": {
      "type": "string",
      "description": "Documentation type (Diátaxis framework)",
      "enum": ["how-to", "tutorial", "reference", "explanation"],
      "examples": ["how-to"]
    },
    "last_updated": {
      "type": "string",
      "description": "Date documentation was last updated (YYYY-MM-DD)",
      "pattern": "^\\d{4}-\\d{2}-\\d{2}$",
      "examples": ["2025-11-16"]
    },
    "created": {
      "type": "string",
      "description": "Date documentation was created (YYYY-MM-DD)",
      "pattern": "^\\d{4}-\\d{2}-\\d{2}$",
      "examples": ["2025-10-01"]
    },
    "author": {
      "type": "string",
      "description": "Original author or team",
      "examples": ["auth-team", "Claude Code"]
    },
    "reviewers": {
      "type": "array",
      "description": "Reviewers who validated this documentation",
      "items": {
        "type": "string"
      },
      "minItems": 1,
      "examples": [["Alice", "Bob"]]
    },
    "tags": {
      "type": "array",
      "description": "Tags for categorization and search",
      "items": {
        "type": "string"
      },
      "minItems": 1,
      "examples": [["authentication", "security", "api"]]
    },
    "status": {
      "type": "string",
      "description": "Documentation status",
      "enum": ["draft", "review", "published", "deprecated"],
      "examples": ["published"]
    },
    "version": {
      "type": "string",
      "description": "Documentation version (semantic versioning)",
      "pattern": "^\\d+\\.\\d+\\.\\d+$",
      "examples": ["1.0.0", "2.1.3"]
    },
    "sap_id": {
      "type": "string",
      "description": "SAP ID if this is a SAP document",
      "pattern": "^SAP-\\d{3}$",
      "examples": ["SAP-056", "SAP-010"]
    },
    "scope": {
      "type": "string",
      "description": "SAP scope (for SAP documents only)",
      "enum": ["Governance", "Implementation", "Integration"],
      "examples": ["Governance"]
    },
    "related_docs": {
      "type": "array",
      "description": "Related documentation files (wikilinks or paths)",
      "items": {
        "type": "string"
      },
      "minItems": 1,
      "examples": [["[[authentication-guide]]", "docs/reference/api/auth.md"]]
    },
    "prerequisites": {
      "type": "array",
      "description": "Documents to read before this one",
      "items": {
        "type": "string"
      },
      "minItems": 1,
      "examples": [["docs/getting-started.md", "docs/setup.md"]]
    },
    "audience": {
      "type": "string",
      "description": "Target audience for this documentation",
      "enum": ["developers", "users", "admins", "architects", "all"],
      "examples": ["developers"]
    },
    "difficulty": {
      "type": "string",
      "description": "Difficulty level (for tutorials/how-tos)",
      "enum": ["beginner", "intermediate", "advanced"],
      "examples": ["intermediate"]
    },
    "time_estimate": {
      "type": "string",
      "description": "Estimated time to complete (for tutorials/how-tos)",
      "pattern": "^\\d+(-\\d+)? (minutes|hours|days)$",
      "examples": ["15 minutes", "2-4 hours"]
    },
    "validation_date": {
      "type": "string",
      "description": "Date documentation was last validated against code (YYYY-MM-DD)",
      "pattern": "^\\d{4}-\\d{2}-\\d{2}$",
      "examples": ["2025-11-16"]
    },
    "validation_status": {
      "type": "string",
      "description": "Result of last validation against code",
      "enum": ["valid", "outdated", "needs_review", "unknown"],
      "examples": ["valid"]
    }
  },
  "additionalProperties": true,
  "examples": [
    {
      "title": "How to Implement Authentication",
      "feature_id": "FEAT-001",
      "code_references": [
        "src/auth/providers.py",
        "src/auth/middleware.py"
      ],
      "test_references": [
        "tests/test_auth.py::test_email_login",
        "tests/test_auth_integration.py::test_full_auth_flow"
      ],
      "doc_type": "how-to",
      "last_updated": "2025-11-16",
      "created": "2025-10-01",
      "author": "auth-team",
      "tags": ["authentication", "security", "getting-started"],
      "status": "published",
      "audience": "developers",
      "difficulty": "intermediate",
      "time_estimate": "30 minutes",
      "validation_date": "2025-11-16",
      "validation_status": "valid"
    },
    {
      "title": "Capability Charter: Lifecycle Traceability",
      "sap_id": "SAP-056",
      "version": "1.0.0",
      "status": "draft",
      "scope": "Governance",
      "last_updated": "2025-11-16",
      "doc_type": "reference",
      "author": "Claude Code",
      "tags": ["sap", "traceability", "governance"]
    },
    {
      "title": "Authentication API Reference",
      "feature_ids": ["FEAT-001", "FEAT-002"],
      "code_references": [
        "src/auth/providers.py",
        "src/auth/oauth.py"
      ],
      "doc_type": "reference",
      "last_updated": "2025-11-10",
      "author": "auth-team",
      "tags": ["api", "reference", "authentication"],
      "status": "published",
      "audience": "developers"
    }
  ],
  "definitions": {
    "feature_reference": {
      "type": "string",
      "description": "Reference to a feature (FEAT-XXX format)",
      "pattern": "^FEAT-[A-Z0-9-]+$"
    },
    "file_path": {
      "type": "string",
      "description": "Relative file path from project root",
      "minLength": 1
    },
    "date_string": {
      "type": "string",
      "description": "ISO 8601 date format (YYYY-MM-DD)",
      "pattern": "^\\d{4}-\\d{2}-\\d{2}$"
    }
  }
}
