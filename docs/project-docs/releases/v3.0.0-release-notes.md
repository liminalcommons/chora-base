# chora-base v3.0.0 Release Notes

**Release Date:** 2025-10-25
**Type:** Major Release (Breaking Changes)
**Theme:** AI-Agent-First Architecture

## Overview

chora-base v3.0.0 represents a complete architecture redesign, transforming from a Copier-based template into a **zero-dependency, AI-agent-first development template**. This release eliminates Copier complexity and delivers on the promise of "one-line setup that just works."

## Breaking Changes

### 1. No More Copier Dependency

**Before (v2.x):**
```bash
pipx install copier
copier copy gh:liminalcommons/chora-base my-project
```

**After (v3.0.0):**
```bash
# With AI Agent (recommended)
# Just ask: "Set up chora-base for my project called [name]"

# Manual setup
python setup.py my-project
```

**Migration Path:**
- v2.x projects continue working (no forced upgrade)
- New projects should use v3.0.0
- See [v2-to-v3 Migration Guide](v2-to-v3-migration.md) for upgrade instructions

### 2. Static Template Architecture

**What Changed:**
- 70% of files are now **static** (no variable substitution needed)
- 10 core files are **blueprints** with simple `{{ variable }}` placeholders
- No Jinja2 templating logic required (agents do string replacement)

**File Organization:**
```
chora-base/
├── static-template/     # 91 ready-to-use files (NEW)
├── blueprints/          # 10 core templates with {{ variables }} (NEW)
├── setup.py             # Optional CLI helper (NEW)
└── AGENT_SETUP_GUIDE.md # 2,000+ line comprehensive guide (NEW)
```

### 3. All Features Enabled by Default

**Philosophy Change:**
- v2.x: Minimal by default, opt-in features
- v3.0.0: Comprehensive by default, all features included

**Enabled Features:**
- ✅ Agent Memory System
- ✅ AGENTS.md documentation
- ✅ Testing infrastructure (pytest, 85%+ coverage)
- ✅ Code quality tools (pre-commit, ruff, black, mypy)
- ✅ CI/CD (7 GitHub Actions workflows)
- ✅ Docker support
- ✅ Full documentation suite

**Rationale:** Designed for AI agents who can handle comprehensive setups. Simplification through removal (not addition).

## New Features

### 1. AI Agent Autonomous Setup

**AGENT_SETUP_GUIDE.md** (2,045 lines)
- Complete step-by-step guide for AI coding agents
- Variable reference with derivation rules
- 6-step setup procedure with validation
- Feature flag documentation
- Troubleshooting decision trees
- 3 complete worked examples

**Agent Workflow:**
1. Read AGENT_SETUP_GUIDE.md
2. Copy static-template/ files
3. Process 10 blueprints with variable substitution
4. Rename `__package_name__` directories
5. Initialize git and create first commit
6. Validate setup (file existence, no unreplaced placeholders)

### 2. setup.py CLI Helper

**Features:**
- Interactive prompts for project configuration
- Automatic variable derivation (project_slug, package_name, mcp_namespace)
- Input validation (email, semver, regex patterns)
- Comprehensive error handling
- Post-generation validation

**Usage:**
```bash
python setup.py my-project-name
# Follow interactive prompts
# Project generated in ./my-project-name/
```

**413 lines of production-ready code** with:
- Smart defaults (Python 3.12, MIT license, 0.1.0 version)
- Cross-platform path handling
- Atomic file operations
- Clear error messages

### 3. Static Template System

**91 Static Files** (no processing needed):
- GitHub Actions workflows (8 files)
- Scripts (25+ automation scripts)
- Tests (10+ test files)
- User documentation (14 markdown files)
- Configuration files (.gitignore, .editorconfig, justfile, etc.)
- Docker files (Dockerfile, docker-compose.yml)
- Source code utilities (validation, responses, errors, persistence)
- Memory system implementation (event_log, knowledge_graph, trace)

**10 Core Blueprints** (simple variable substitution):
1. `pyproject.toml.blueprint` - Project metadata
2. `README.md.blueprint` - Project documentation
3. `AGENTS.md.blueprint` - AI agent instructions
4. `CHANGELOG.md.blueprint` - Version history
5. `ROADMAP.md.blueprint` - Development roadmap
6. `.gitignore.blueprint` - Git ignore patterns
7. `.env.example.blueprint` - Environment variables
8. `server.py.blueprint` - MCP server entry point
9. `mcp__init__.py.blueprint` - MCP package init
10. `package__init__.py.blueprint` - Root package init

### 4. Zero-Dependency Philosophy

**What This Means:**
- No Copier installation required
- No Jinja2 runtime needed
- AI agents use simple string replacement
- Manual users run one Python script

**Benefits:**
- Faster setup (no pip installs before starting)
- More reliable (fewer moving parts)
- Easier to understand (no templating DSL)
- Better for CI/CD (fewer dependencies to cache)

## Improvements

### Variable Derivation

**Automatic derivation** from `project_name`:

| Input | Derived Variables |
|-------|------------------|
| `my-awesome-project` | `project_slug`: `my-awesome-project`<br>`package_name`: `my_awesome_project`<br>`mcp_namespace`: `myawesomeproject` |
| `mcp-orchestration` | `project_slug`: `mcp-orchestration`<br>`package_name`: `mcp_orchestration`<br>`mcp_namespace`: `mcporchestration` |

**Rules:**
- `project_slug`: kebab-case (hyphens)
- `package_name`: snake_case (underscores)
- `mcp_namespace`: lowercase alphanumeric (3-20 chars)

### Validation System

**File Existence Checks:**
- pyproject.toml
- README.md
- AGENTS.md
- src/{package_name}/__init__.py
- src/{package_name}/mcp/server.py
- tests/ directory

**Placeholder Detection:**
- Scans key files for unreplaced `{{ variables }}`
- Reports specific files with issues
- Provides clear remediation steps

**Import Testing:**
- Verifies package can be imported
- Catches syntax errors early
- Validates Python path setup

### Developer Experience

**One-Line Setup:**
```bash
# For agents
"Set up chora-base for my MCP server called [name]"

# For humans
python setup.py my-project
```

**Clear Success Criteria:**
- All files generated
- No template placeholders remain
- Package imports successfully
- Git initialized with first commit

**Comprehensive Documentation:**
- [AGENT_SETUP_GUIDE.md](../../AGENT_SETUP_GUIDE.md) - For AI agents
- [README.md](../../README.md) - For human developers
- [This release note](v3.0.0-release-notes.md) - Migration guide

## Testing

### Validation Test

Generated test project at `/tmp/test-mcp-example`:
- ✅ All 91 static files copied correctly
- ✅ All 10 blueprints processed successfully
- ✅ 90% of variables replaced ({{ placeholders }} → values)
- ✅ Package structure created (src/test_mcp_server/)
- ✅ Git initialized with clean commit

**Known Issue (acceptable for MVP):**
- Some Jinja2 conditionals (`{% if %}`) remain in blueprints
- These are for optional features (CLI framework selection, etc.)
- AI agents can handle these or they'll be simplified in v3.1.0

### Manual Testing

Verified:
- ✅ setup.py runs on macOS (Darwin 24.6.0)
- ✅ Interactive prompts work correctly
- ✅ Variable derivation produces correct values
- ✅ Validation catches missing files
- ✅ Validation detects unreplaced placeholders
- ✅ Error messages are clear and actionable

## Migration Guide

### For New Projects

**Just use v3.0.0:**
```bash
# With AI agent
"Set up chora-base v3.0.0 for my project called [name]"

# Manual
git clone https://github.com/liminalcommons/chora-base.git
cd chora-base
python setup.py my-project
```

### For Existing v2.x Projects

**Option 1: Stay on v2.x** (recommended for stable projects)
- No forced upgrade required
- v2.x continues to work
- Update when convenient (not urgent)

**Option 2: Migrate to v3.0.0** (for new features)
1. Read [v2-to-v3 Migration Guide](v2-to-v3-migration.md)
2. Back up your project (git commit everything)
3. Generate fresh v3.0.0 project
4. Merge your customizations into new structure
5. Test thoroughly before committing

See [v2-to-v3-migration.md](v2-to-v3-migration.md) for detailed steps.

### For Template Contributors

**What Changed:**
- No more `template/` directory
- Files split into `static-template/` (91 files) and `blueprints/` (10 files)
- No more `copier.yml` configuration
- Variables defined in AGENT_SETUP_GUIDE.md and setup.py

**Contributing Now:**
1. Edit files in `static-template/` or `blueprints/`
2. Update AGENT_SETUP_GUIDE.md if adding variables
3. Update setup.py if changing blueprint mappings
4. Test with `python setup.py test-project`
5. Submit PR with test results

## Deprecations

### Removed Features

**Copier Integration:**
- No more `.copier-answers.yml`
- No more `copier update` command
- Manual merge required for template updates

**Variable Templating:**
- No more Jinja2 filters (like `| slugify`)
- No more Jinja2 conditionals in static files
- Simple `{{ variable }}` replacement only

**Feature Flags:**
- No opt-out for features (all enabled by default)
- Removal via deleting files/directories post-generation

### Backward Compatibility

**v2.x Projects:**
- Continue working without changes
- No forced migration required
- Copier-based workflow still supported for v2.x

**Template Updates:**
- v3.0.0 does not support `copier update` from v2.x
- Migration requires fresh generation + manual merge
- See migration guide for detailed process

## Known Issues

### 1. Jinja2 Conditionals in Blueprints

**Issue:** Some blueprints contain `{% if %}` conditionals for optional features.

**Impact:**
- Agents may need to handle or remove these manually
- ~10% of placeholders remain in generated projects

**Workaround:**
- Agents: Implement conditional logic or remove unused blocks
- Humans: Manually edit generated files to remove

**Fix Planned:** v3.1.0 will simplify blueprints to pure `{{ variable }}` replacement

### 2. No Automatic Template Updates

**Issue:** v3.0.0 doesn't provide automatic merge like `copier update`.

**Impact:**
- Template updates require manual comparison
- More work for project maintainers

**Workaround:**
```bash
# Compare your project against latest chora-base
cd /path/to/chora-base && git pull
diff -r static-template/ /path/to/your-project/
# Merge improvements manually
```

**Future:** May add update tooling in v3.2.0+

### 3. Limited Cross-Platform Testing

**Issue:** Tested primarily on macOS (Darwin 24.6.0).

**Impact:**
- May have path/encoding issues on Windows
- Linux likely works but untested

**Status:**
- Community testing welcome
- Will fix platform-specific issues in patch releases

## Upgrade Recommendations

### Who Should Upgrade Now

✅ **New projects** - Always use v3.0.0
✅ **Projects experiencing Copier issues** - v3.0.0 eliminates Copier problems
✅ **AI agent workflows** - v3.0.0 designed specifically for agents

### Who Should Wait

⏳ **Stable v2.x projects** - No urgent need to upgrade
⏳ **Projects with heavy customization** - Wait for v3.1.0 simplifications
⏳ **Windows/Linux users** - Wait for cross-platform testing confirmation

## Resources

**Documentation:**
- [AGENT_SETUP_GUIDE.md](../../AGENT_SETUP_GUIDE.md) - Complete setup guide for AI agents
- [README.md](../../README.md) - Updated for v3.0.0 architecture
- [v2-to-v3 Migration Guide](v2-to-v3-migration.md) - Detailed upgrade instructions
- [CHANGELOG.md](../../CHANGELOG.md) - Full change history

**Code:**
- [setup.py](../../setup.py) - Optional CLI helper script
- [static-template/](../../static-template/) - 91 ready-to-use files
- [blueprints/](../../blueprints/) - 10 core templates

**Examples:**
- Test project: `/tmp/test-mcp-example` (generated during validation)

**Support:**
- [GitHub Issues](https://github.com/liminalcommons/chora-base/issues)
- [GitHub Discussions](https://github.com/liminalcommons/chora-base/discussions)

## Acknowledgments

**Architecture Inspiration:**
- Experience from 9 failed v2.x releases (v2.0.6-v2.0.9)
- Copier complexity feedback from adopters
- AI agent setup friction observations

**Design Principles:**
- Zero dependencies > Template power features
- Static files > Dynamic generation
- All features enabled > Configuration complexity
- Agent autonomy > Human intervention

**Contributors:**
- @victorpiper - Architecture design and implementation
- chora-base community - Feedback and testing

## What's Next

### v3.1.0 (Planned)

**Simplify Blueprints:**
- Remove Jinja2 conditionals from blueprints
- Pure `{{ variable }}` replacement only
- Pre-generate variants for optional features

**Enhanced Validation:**
- Cross-platform testing (Windows, Linux)
- More comprehensive file checks
- Better error messages

### v3.2.0+ (Future)

**Update Tooling:**
- Script to compare project vs latest template
- Automated merge suggestions
- Git-style conflict resolution

**Agent Enhancements:**
- Improved AGENT_SETUP_GUIDE.md examples
- Common troubleshooting scenarios
- Integration with agent memory system

---

**Full Changelog:** [CHANGELOG.md](../../CHANGELOG.md#300---2025-10-25)
**Migration Guide:** [v2-to-v3-migration.md](v2-to-v3-migration.md)
**Setup Guide:** [AGENT_SETUP_GUIDE.md](../../AGENT_SETUP_GUIDE.md)
