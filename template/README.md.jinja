{# Compute SAP enablement inline #}
{% set sap_001 = sap_selection_mode != 'custom' or (include_sap_001 | default(false)) %}
{% set sap_015 = sap_selection_mode != 'custom' or (include_sap_015 | default(false)) %}
{% set sap_053 = sap_selection_mode in ['standard', 'comprehensive'] or (sap_selection_mode == 'custom' and (include_sap_053 | default(false))) %}
{% set sap_010 = sap_selection_mode in ['standard', 'comprehensive'] or (sap_selection_mode == 'custom' and (include_sap_010 | default(false))) %}
{% set sap_051 = sap_selection_mode == 'comprehensive' or (sap_selection_mode == 'custom' and (include_sap_051 | default(false))) %}
{% set sap_052 = sap_selection_mode == 'comprehensive' or (sap_selection_mode == 'custom' and (include_sap_052 | default(false))) %}
{% set sap_056 = sap_selection_mode == 'comprehensive' or (sap_selection_mode == 'custom' and (include_sap_056 | default(false))) %}
{% set sap_008 = sap_selection_mode == 'comprehensive' or (sap_selection_mode == 'custom' and (include_sap_008 | default(false))) %}
{% set sap_total = [sap_001, sap_015, sap_053, sap_010, sap_051, sap_052, sap_056, sap_008] | select | list | length %}
# {{ project_name }}

{{ project_description }}

**Author**: {{ project_author }}
**Created**: {{ '%Y-%m-%d' | strftime }}
**Template**: chora-base v1.0.0 (Copier-based SAP Distribution)

---

## Quick Start

```bash
# Show available automation recipes
just --list

{% if sap_001 %}# Check coordination inbox status
just inbox-status
{% endif %}
{% if sap_053 %}# Run conflict detection
just conflict-check
{% endif %}
{% if sap_015 %}# List beads tasks
bd list
{% endif %}
```

---

## Common Workflows

This section provides typical workflows for working with this project:

{% if sap_001 %}**Coordination Workflow**:
1. Check inbox: `just inbox-status`
2. Review coordination requests in `inbox/incoming/coordination/`
3. Move to `inbox/active/` when starting work
4. Move to `inbox/completed/` when done
{% endif %}

{% if sap_053 %}**Pre-merge Workflow**:
1. Make changes on feature branch
2. Run `just conflict-check` before merging
3. Address any conflicts detected
4. Merge when clean
{% endif %}

{% if sap_015 %}**Task Management Workflow**:
1. Create task: `bd create "Task description"`
2. List tasks: `bd list`
3. Update task: `bd update <task-id> --status in_progress`
4. Complete task: `bd close <task-id>`
{% endif %}

---

## SAPs Included

This project includes {{ sap_total }} Skilled Awareness Packages (SAPs) for workflow automation and coordination:

{% if sap_001 %}### SAP-001: Inbox Workflow

**Purpose**: Coordination request management and cross-project communication

**Key Files**:
- `inbox/incoming/coordination/` - New coordination requests
- `inbox/templates/` - Request templates
- `ECOSYSTEM_STATUS.yaml` - Status tracking

**Recipes**:
```bash
just inbox-status         # Show coordination dashboard
just inbox-list           # List all requests
```

**Documentation**: [inbox/README.md](inbox/README.md)

{% endif %}
{% if sap_015 %}### SAP-015: Beads Task Management

**Purpose**: Git-backed issue tracking with JSONL storage

**Key Files**:
- `.beads/issues.jsonl` - Task storage
- `.beads/` - Beads database

**Recipes**:
```bash
bd create "Task title"           # Create new task
bd list                          # List all tasks
bd show <id>                     # Show task details
bd close <id> --reason "Done"    # Close task
```

**Documentation**: Beads CLI help (`bd --help`)

{% endif %}
{% if sap_053 %}### SAP-053: Conflict Resolution

**Purpose**: Pre-merge conflict detection (v1.0.0)

**Key Files**:
- `scripts/conflict-checker.py` - Conflict detection script
- `docs/conflict-resolution/README.md` - Full documentation

**Recipes**:
```bash
just conflict-check              # Check for conflicts with main
just conflict-check-json         # JSON output for CI/CD
just conflict-check-verbose      # Detailed output
just conflict-status             # Quick status check
```

**Documentation**: [docs/conflict-resolution/README.md](docs/conflict-resolution/README.md)

{% endif %}
{% if sap_010 %}### SAP-010: Memory System

**Purpose**: A-MEM event logging and knowledge note management

**Key Files**:
- `.chora/memory/events/` - Event logs (JSONL format)
- `.chora/memory/knowledge/notes/` - Knowledge notes (markdown + wikilinks)
- `.chora/CLAUDE.md` - Agent awareness guide

**Recipes**:
```bash
just memory-events 10            # Show recent 10 events
just knowledge-list 10           # List recent knowledge notes
just memory-validate             # Validate event schema
```

**Documentation**: [.chora/CLAUDE.md](.chora/CLAUDE.md)

{% endif %}
{% if sap_051 %}### SAP-051: Pre-merge Validation

**Purpose**: Git hooks for pre-push checks

**Key Files**:
- `.git/hooks/pre-push` - Pre-push validation hook
- `scripts/pre-push-check.sh` - Validation script

**Recipes**:
```bash
just pre-push-check              # Run pre-push validation manually
```

**Documentation**: [docs/pre-merge-validation/README.md](docs/pre-merge-validation/README.md)

{% endif %}
{% if sap_052 %}### SAP-052: Code Ownership

**Purpose**: CODEOWNERS and PR reviewer suggestions

**Key Files**:
- `CODEOWNERS` - GitHub code ownership
- `scripts/suggest-reviewers.py` - Reviewer suggestion script

**Recipes**:
```bash
just ownership-suggest-reviewers-staged    # Suggest reviewers for staged changes
just ownership-coverage                    # Check ownership coverage
```

**Documentation**: [docs/code-ownership/README.md](docs/code-ownership/README.md)

{% endif %}
{% if sap_056 %}### SAP-056: Lifecycle Traceability

**Purpose**: Feature manifest and artifact linkage

**Key Files**:
- `feature-manifest.yaml` - Single source of truth for features
- `scripts/validate-manifest.py` - Manifest validation script

**Recipes**:
```bash
just feature-manifest-validate    # Validate feature manifest
just feature-manifest-generate    # Generate manifest from git/beads
```

**Documentation**: [docs/lifecycle-traceability/README.md](docs/lifecycle-traceability/README.md)

{% endif %}
{% if sap_008 %}### SAP-008: Automation Dashboard

**Purpose**: Justfile recipes and metrics tracking

**Key Files**:
- `justfile` - Automation recipes
- `scripts/track-recipe-usage.py` - Usage tracking script

**Recipes**:
```bash
just --list                      # Show all recipes
just automation-stats            # Show automation metrics
```

**Documentation**: [docs/automation-dashboard/README.md](docs/automation-dashboard/README.md)

{% endif %}

---

## Development

### Prerequisites

{% if sap_053 or sap_056 or sap_008 %}- **Python {{ python_version }}+**: Required for SAP scripts
{% if use_poetry %}- **Poetry**: Python dependency management{% endif %}
{% endif %}{% if use_git %}- **Git**: Version control{% endif %}
{% if sap_015 %}- **Beads CLI**: Task management (`go install github.com/liminalcommons/beads/cmd/bd@latest`){% endif %}
- **just**: Task runner (`brew install just` or see https://just.systems)

### Setup

```bash
{% if use_git %}# 1. Git repository already initialized
git status
{% endif %}
{% if use_poetry and (sap_053 or sap_056 or sap_008) %}# 2. Install Python dependencies
poetry install
{% endif %}
# 3. View available recipes
just --list

{% if sap_001 %}# 4. Check inbox status
just inbox-status
{% endif %}
```

### Project Structure

```
{{ _project_slug }}/
├── README.md                    # This file
├── justfile                     # Automation recipes
{% if sap_053 or sap_056 or sap_008 %}├── pyproject.toml               # Python dependencies{% endif %}
├── scripts/                     # SAP scripts
{% if sap_053 %}│   ├── conflict-checker.py      # SAP-053{% endif %}
{% if sap_010 %}│   ├── memory-health-check.py   # SAP-010{% endif %}
{% if sap_052 %}│   ├── suggest-reviewers.py     # SAP-052{% endif %}
{% if sap_056 %}│   ├── validate-manifest.py     # SAP-056{% endif %}
│   └── ...
├── docs/                        # Documentation
{% if sap_001 %}├── inbox/                       # SAP-001: Coordination requests
│   ├── incoming/
│   ├── templates/
│   └── README.md
{% endif %}{% if sap_010 %}├── .chora/                      # SAP-010: Memory system
│   ├── memory/
│   │   ├── events/
│   │   └── knowledge/
│   └── CLAUDE.md
{% endif %}{% if sap_015 %}├── .beads/                      # SAP-015: Beads tasks
│   └── issues.jsonl
{% endif %}{% if use_git %}└── .git/                        # Git repository{% endif %}
```

---

## Resources

### chora Ecosystem
- **chora-base**: https://github.com/liminalcommons/chora-base
- **SAP Catalog**: [packages/chora-base/docs/skilled-awareness/INDEX.md](https://github.com/liminalcommons/chora-base/blob/main/docs/skilled-awareness/INDEX.md)
- **Template Documentation**: [COPIER-QUESTIONNAIRE-DESIGN.md](https://github.com/liminalcommons/chora-base/blob/main/COPIER-QUESTIONNAIRE-DESIGN.md)

### Template Updates

This project was generated from the chora-base Copier template. When the template improves, you can update your project to receive enhancements while preserving your customizations.

#### When to Update

Update your project when chora-base releases:
- **New SAP features**: Enhanced scripts, recipes, or documentation
- **Bug fixes**: Corrections to template files or scripts
- **Security patches**: Critical updates to dependencies or workflows
- **Major versions**: Significant template improvements (review changelog first)

#### Update Workflow

```bash
# 1. Ensure working directory is clean
git status
git stash  # If you have uncommitted changes

# 2. Update to latest template version
copier update

# 3. Review changes proposed by copier
# Copier will show a diff of changes and prompt for conflicts

# 4. Resolve conflicts if any (see below)
git diff
git status

# 5. Test SAP scripts after update
{% if sap_053 %}just conflict-check{% endif %}
{% if sap_001 %}just inbox-status{% endif %}
just --list

# 6. Commit merged result
git add -A
git commit -m "Update from chora-base template vX.Y.Z"
```

#### Conflict Resolution

When template updates conflict with your customizations, copier uses git's 3-way merge. Common scenarios:

**Low-Conflict (Automatic Merge)**:
- Template adds new section to README → Your custom sections preserved
- Template updates justfile recipe → Your recipes untouched
- Template adds new file → Your custom files preserved

**High-Conflict (Manual Resolution)**:
- You and template both modified same section → Manual merge required
- Template removes file you customized → Decide: keep or adopt template change

**Resolution Strategy**:
1. Review conflict markers in files (`<<<<<<<`, `=======`, `>>>>>>>`)
2. Keep both changes when compatible (merge manually)
3. Choose template change for bug fixes/security patches
4. Keep your customization for project-specific logic
5. Test thoroughly after resolution

#### Rollback Strategy

If update causes issues:

```bash
# Rollback to pre-update state
git log --oneline  # Find commit before update
git reset --hard <commit-before-update>

# Or create a branch first (safer):
git checkout -b template-update-vX.Y.Z
copier update
# Test, then merge to main when validated
```

**Update Guide**: For detailed conflict scenarios and resolution patterns, see [chora-base documentation](https://github.com/liminalcommons/chora-base)

---

## Contributing

### Adding New Features
{% if sap_015 %}1. Create beads task: `bd create "Feature description"`
2. Implement feature
3. Close task: `bd close <id> --reason "Implemented"`
{% else %}1. Create issue/task for feature
2. Implement feature
3. Close issue when complete
{% endif %}

### Reporting Issues
{% if sap_001 %}- Create coordination request in `inbox/incoming/coordination/` (for cross-project issues)
{% endif %}- Open GitHub issue (if repository is public)
- Contact maintainer: {{ project_author }}

---

## License

[Add your license here]

---

**Template Version**: chora-base v1.0.0 (Copier-based SAP Distribution)
**Origin**: OPP-2025-022, CORD-2025-023, SAP-060 Strategic Opportunity Management
**Generated**: {{ '%Y-%m-%d %H:%M:%S' | strftime }}

## Troubleshooting

Common issues and solutions:

{% if sap_053 %}**Conflict Detection Issues**:
- Ensure you're on a clean branch before running `just conflict-check`
- Check that the target branch exists
{% endif %}

{% if sap_001 %}**Inbox Workflow Issues**:
- Verify JSON schema in coordination requests
- Check file permissions in inbox directories
{% endif %}

For more help, see `docs/GETTING-STARTED.md`.
